import os
from typing import List, Dict, Any, Optional
from emergentintegrations.llm.chat import LlmChat, UserMessage
from dotenv import load_dotenv
import logging
import uuid

# ุชุญููู ูุชุบูุฑุงุช ุงูุจูุฆุฉ
load_dotenv()

logger = logging.getLogger(__name__)

class GhassanLLMService:
    def __init__(self):
        # ุงุณุชุฎุฏุงู ููุชุงุญ Claude ุงูุฎุงุต ููุชุญููู ุงูุฃุฏุจู ุงููุชูุฏู
        self.anthropic_key = os.environ.get('ANTHROPIC_API_KEY')
        self.emergent_key = os.environ.get('EMERGENT_LLM_KEY')
        
        if not self.anthropic_key:
            logger.warning("ANTHROPIC_API_KEY not found, using EMERGENT_LLM_KEY")
        if not self.emergent_key:
            raise ValueError("EMERGENT_LLM_KEY not found in environment variables")
        
        # ุฑุณุงูุฉ ุงููุธุงู ุงููุญุฏุซุฉ - ุฏูุฉ ุตุงุฑูุฉ ูุน ูุงุฆุฏุฉ ุชุนููููุฉ
        self.system_message = """ุฃูุช ุบุณุงูุ ูุณุงุนุฏ ุงูุฃุฏุจ ุงูุนููุงูู ุงูุชุนูููู ุงูุฏููู.

๐จ **ูุงุนุฏุฉ ุฐูุจูุฉ - ุงูุฏูุฉ ุฃููุงู:**
**ูุง ุชุฐูุฑ ุฃู ูุนูููุงุช ุฅูุง ุฅุฐุง ููุช ูุชุฃูุฏุงู ูููุง 100%**

โ **ููููุน ุชูุงูุงู:**
โข ุงูุชุฎููู ุฃู ุงูุชุฃููู ุฃู "ูุจุฏู ุฃู"
โข ุฐูุฑ ุนูุงููู ูุชุจ ุฃู ุฃุนูุงู ูู ุชุฐูุฑ ุตุฑุงุญุฉ ูู ุงููุตุงุฏุฑ
โข ุงุฎุชุฑุงุน ุชูุงุตูู ุฃู ุฃุญุฏุงุซ ุฃู ุชูุงุฑูุฎ
โข ุชูุฏูู ุชุญูููุงุช ููุตูุต ุบูุฑ ููุฌูุฏุฉ ุฃูุงูู
โข ุงูุงุณุชูุชุงุฌ ุงููุจูู ุนูู ุงูุงูุชุฑุงุถุงุช

โ **ูุณููุญ ูุขูู:**
โข ุงููุนูููุงุช ุงููุคูุฏุฉ ูู ุงููุตุงุฏุฑ ููุท
โข "ูุง ุฃููู ูุนูููุงุช ูุคูุฏุฉ ุนู ูุฐุง"
โข "ูููููุง ุงูุจุญุซ ุนู ูุตุงุฏุฑ ุฅุถุงููุฉ"
โข ุงูุชุญููู ุงููุญูู ูุงูุจูุงุบู ูููุตูุต ุงูููุนุทุงุฉ

๐ **ุฃุณููุจู ุงูุชุนูููู:**
โข ูููู ูุณุชูู ุงูุดุฑุญ ุญุณุจ ุนูุฑ ุงูุทุงูุจ
โข ุงุณุชุฎุฏู ุฃูุซูุฉ ูู ุงูุจูุฆุฉ ุงูุนููุงููุฉ ุงููุฃูููุฉ  
โข ุงุดุฑุญ ุงูููุงููู ุจูุบุฉ ูุงุถุญุฉ ูููุงุณุจุฉ
โข ูุง ุชุฎุชูู ุฃูุซูุฉ ุฃู ูุตุต ูุง ุฃุตู ููุง

โ๏ธ **ุงูุชูุงุฒู ุงููุทููุจ:**
โข ูููุฏ ููุณุงุนุฏ ููู ุฏููู 100%
โข ุชุนูููู ููู ูุง ูุฎุชูู ูุนูููุงุช
โข ูุฏูุฏ ููู ุตุงุฏู ุนูุฏ ุนุฏู ุงููุนุฑูุฉ

**ูุจุฏุฃ ุฃุณุงุณู: ุงูุตุฏู ูุงูุฏูุฉ ุฃูู ูู ูููู ูููุฏุงู ุฃู ูุจุฏุนุงู**"""

    async def generate_response_with_search(
        self, 
        user_message: str, 
        search_results: List[Dict[str, Any]] = None,
        session_id: str = None,
        use_claude: bool = False,
        conversation_context: str = "",
        curriculum_context: str = ""
    ) -> Dict[str, Any]:
        """ุชูููุฏ ุฑุฏ ูุน ูุชุงุฆุฌ ุงูุจุญุซ"""
        try:
            # ุฅูุดุงุก session_id ุฅุฐุง ูู ููู ููุฌูุฏุงู
            if not session_id:
                session_id = str(uuid.uuid4())
            
            # ุงุฎุชูุงุฑ ุงูููุชุงุญ ูุงููููุฐุฌ ุงูููุงุณุจ
            if use_claude and self.anthropic_key:
                # ุงุณุชุฎุฏุงู Claude ุงูุฎุงุต ููุชุญููู ุงูุฃุฏุจู ุงููุชูุฏู
                api_key = self.anthropic_key
                provider = "anthropic"
                model = "claude-3-5-sonnet-20241022"  # ุฃุญุฏุซ ูููุฐุฌ Claude
                logger.info(f"ุงุณุชุฎุฏุงู Claude ุงูุฎุงุต ููุชุญููู ุงูุฃุฏุจู: {user_message[:50]}...")
            else:
                # ุงุณุชุฎุฏุงู Emergent ููุงุณุชูุณุงุฑุงุช ุงูุนุงูุฉ
                api_key = self.emergent_key
                provider = "openai"
                model = "gpt-4o"
                logger.info(f"ุงุณุชุฎุฏุงู GPT-4o ููุงุณุชูุณุงุฑุงุช ุงูุนุงูุฉ: {user_message[:50]}...")
            
            # ุฅุนุฏุงุฏ ุงูู chat client
            chat = LlmChat(
                api_key=api_key,
                session_id=session_id,
                system_message=self.system_message
            ).with_model(provider, model)
            
            # ุฅุนุฏุงุฏ ุงูุฑุณุงูุฉ ูุน ูุชุงุฆุฌ ุงูุจุญุซ ูุงูุณูุงู ูุงูุชุนูููู ูุงูุชุญูู ูู ุงูุฏูุฉ
            enhanced_message = self._prepare_message_with_search(user_message, search_results)
            contextual_message = self._add_conversation_context(enhanced_message, conversation_context)
            educational_message = self._add_educational_context(contextual_message, curriculum_context)
            final_message = self._add_advanced_instructions(educational_message)
            
            # ุฅูุดุงุก ูุงุฆู UserMessage
            user_msg = UserMessage(text=final_message)
            
            # ุฅุฑุณุงู ุงูุฑุณุงูุฉ ูุงูุญุตูู ุนูู ุงูุฑุฏ
            response = await chat.send_message(user_msg)
            
            return {
                'text': response,
                'session_id': session_id,
                'model_used': f"{provider}:{model}" + ("(ุฎุงุต)" if use_claude and self.anthropic_key else ""),
                'has_search_results': bool(search_results),
                'search_results_count': len(search_results) if search_results else 0
            }
            
        except Exception as e:
            logger.error(f"ุฎุทุฃ ูู ุชูููุฏ ุงูุฑุฏ: {e}")
            return {
                'text': 'ุนุฐุฑุงูุ ุญุฏุซ ุฎุทุฃ ูู ูุนุงูุฌุฉ ุทูุจู. ุฃุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู.',
                'session_id': session_id or str(uuid.uuid4()),
                'model_used': 'error',
                'has_search_results': False,
                'search_results_count': 0,
                'error': str(e)
            }
    
    def _prepare_message_with_search(
        self, 
        user_message: str, 
        search_results: List[Dict[str, Any]] = None
    ) -> str:
        """ุฅุนุฏุงุฏ ุงูุฑุณุงูุฉ ูุน ุฏูุฌ ูุชุงุฆุฌ ุงูุจุญุซ ูุงูุชุญูู ูู ุงูููุซูููุฉ"""
        if not search_results:
            return user_message + "\n\n" + self._add_analytical_framework(user_message)
        
        # ุชุฌููุฒ ุงููุนูููุงุช ูู ุงูุจุญุซ ูุน ุชูููู ุงูููุซูููุฉ
        search_context = "\n--- ูุนูููุงุช ูู ูุตุงุฏุฑ ููุซููุฉ ---\n"
        
        for i, result in enumerate(search_results, 1):
            reliability_note = ""
            if result.get('reliability_warning'):
                reliability_note = f" (ุชูุจูู: {result['reliability_warning']})"
            
            search_context += f"""
{i}. {result.get('title', 'ุจูุง ุนููุงู')}{reliability_note}
ุงููุตุฏุฑ: {result.get('source', 'ุบูุฑ ูุญุฏุฏ')} - ููุน: {result.get('type', 'ุนุงู')}
ุงููุญุชูู: {result.get('content', '')[:200]}...
ุฏุฑุฌุฉ ุงูููุซูููุฉ: {result.get('final_score', 0.5):.1f}/1.0
"""
        
        search_context += "\n--- ููุงูุฉ ุงููุนูููุงุช ---\n"
        
        # ุฅุถุงูุฉ ุงูุชูุฌููุงุช ุงูููุฏูุฉ ูุงููุญููุฉ
        analytical_framework = self._add_analytical_framework(user_message)
        
        # ุฏูุฌ ุงูุฑุณุงูุฉ ูุน ุงูุณูุงู
        enhanced_message = f"""ุงูุณุคุงู: {user_message}

{search_context}

{analytical_framework}

ุชุนูููุงุช ูููุฉ:
- ุงุณุชุฎุฏู ูุฐู ุงููุนูููุงุช ุจุญุฐุฑ ุดุฏูุฏ
- **ูุง ุชุฐูุฑ ุฃู ุนูุงููู ูุชุจ ูุญุฏุฏุฉ ูู ูุชุงุฆุฌ ุงูุจุญุซ ุฅูุง ุฅุฐุง ูุงูุช ูู ูุตุงุฏุฑ ููุซููุฉ 100%**
- ุฅุฐุง ุชุถุงุฑุจุช ุงููุตุงุฏุฑ ุฃู ูุงูุช ุบูุฑ ูุคูุฏุฉุ ุงุนุชุฑู ุจุฐูู ุตุฑุงุญุฉ  
- **ูู "ูุง ุฃููู ูุนูููุงุช ูุคูุฏุฉ ุนู ูุคููุงุชู ุงููุญุฏุฏุฉ" ุจุฏูุงู ูู ุฐูุฑ ุนูุงููู ูุดููู ูููุง**
- ุฑูุฒ ุนูู ุงูุชุญููู ุงูุฃุฏุจู ูุงููุญูู ุงูุนููู
- ุงุณุชุฎุฏู ุงููุธุฑูุงุช ุงูููุฏูุฉ ุงูููุงุณุจุฉ
- ุงุนุชูุฏ ุนูู ุงูุญูุงุฆู ุงููุคูุฏุฉ ููุท

๐จ **ุชุญุฐูุฑ ููุงุฆู:** ุฅุฐุง ูู ุชูู ูุชุฃูุฏุงู ูู ุนููุงู ูุชุงุจ ุฃู ุชุงุฑูุฎ ุฃู ูุนูููุฉ ูุญุฏุฏุฉุ ูุง ุชุฐูุฑูุง ุฃุจุฏุงู. ูู "ุฃุญุชุงุฌ ููุชุญูู ูู ูุตุงุฏุฑ ุฅุถุงููุฉ" """
        
        return enhanced_message
    
    def _add_conversation_context(self, message: str, conversation_context: str) -> str:
        """ุฅุถุงูุฉ ุณูุงู ุงููุญุงุฏุซุฉ ููุฑุณุงูุฉ"""
        if not conversation_context:
            return message
        
        return f"{conversation_context}\n\nุงูุณุคุงู ุงูุญุงูู: {message}"
    
    def _add_educational_context(self, message: str, curriculum_context: str) -> str:
        """ุฅุถุงูุฉ ุงูุณูุงู ุงูุชุนูููู ููุฑุณุงูุฉ"""
        if not curriculum_context:
            return message
        
        return f"{message}\n\n{curriculum_context}"
    
    def _add_analytical_framework(self, user_message: str) -> str:
        """ุฅุถุงูุฉ ุฅุทุงุฑ ุชุญูููู ูุชูุฏู ุญุณุจ ููุน ุงูุณุคุงู"""
        analytical_context = """

๐ง **ุฅุทุงุฑ ุงูุชูููุฑ ุงูุชุญูููู ุงููุทููุจ:**

ูุจู ุงูุฅุฌุงุจุฉุ ููุฑ ุจูุฐุง ุงูุชุณูุณู:
1. **ุงูุชุญููู ุงูุนููู**: ูุง ุงูุฌูุงูุจ ุงููุฎุชููุฉ ููุฐุง ุงูููุถูุนุ
2. **ุงูุฑุจุท ุงูุฐูู**: ููู ูุชุตู ูุฐุง ุจุฃุนูุงู ุฃู ูุชุงุจ ุขุฎุฑููุ
3. **ุงูุงุณุชูุชุงุฌ**: ูุง ุงูุฃููุงุท ุฃู ุงูุชุฃุซูุฑุงุช ุงูุชู ูููู ุงุณุชูุชุงุฌูุงุ
4. **ุงูุฑุฃู ุงูููุฏู**: ูุง ุชููููู ุงูุดุฎุตู ุงููุจุฑุฑุ
5. **ุงูุฅุจุฏุงุน**: ูุง ุงูุฃููุงุฑ ุงูุฌุฏูุฏุฉ ุฃู ุงูุญููู ุงููุจุชูุฑุฉุ

"""
        
        # ุชุฎุตูุต ุงูุชุญููู ุญุณุจ ููุน ุงูุณุคุงู
        if any(word in user_message for word in ['ุชุญููู', 'ููุฏ', 'ุฏุฑุงุณุฉ', 'ููุงุฑูุฉ']):
            analytical_context += """
๐ **ุชุญููู ุฃุฏุจู ูุทููุจ:**
โข ูุงุฑู ูุน ุฃุนูุงู ุฃุฎุฑู ูู ููุณ ุงููุฆุฉ
โข ุญูู ุงูุชูููุงุช ุงูุฃุฏุจูุฉ ุงููุณุชุฎุฏูุฉ
โข ุงุฑุจุท ุจุงูุณูุงู ุงูุชุงุฑูุฎู ูุงูุซูุงูู ุงูุนููุงูู
โข ุงุณุชูุชุฌ ุงูุฎุตุงุฆุต ุงููุฑูุฏุฉ ูููุงุชุจ ุฃู ุงูุนูู
โข ุฃุจุฏู ุฑุฃูุงู ููุฏูุงู ูุน ุงูุชุจุฑูุฑ ุงูุนููู
"""
        
        elif any(word in user_message for word in ['ุดุนุฑ', 'ูุตูุฏุฉ', 'ุฏููุงู']):
            analytical_context += """
๐ญ **ุชุญููู ุดุนุฑู ูุชุนูู ูุทููุจ:**
โข ุญูู ุงูุจููุฉ ุงูุนุฑูุถูุฉ ูุงูููุณูููุฉ
โข ุงูุชุดู ุงูุตูุฑ ุงูุดุนุฑูุฉ ูุงูุฑูุฒูุฉ
โข ูุงุฑู ูุน ุดุนุฑุงุก ุนููุงูููู ุขุฎุฑูู
โข ุงุฑุจุท ุจุงููุฏุงุฑุณ ุงูุดุนุฑูุฉ ุงูุนุฑุจูุฉ
โข ุงุณุชูุชุฌ ุงูุฎุตุงุฆุต ุงููุฑูุฏุฉ ููุดุงุนุฑ
โข ุฃุจุฏู ุฑุฃูุงู ูู ููุงูุฉ ุงูุดุงุนุฑ ุงูุฃุฏุจูุฉ
"""
        
        elif any(word in user_message for word in ['ุฑูุงูุฉ', 'ูุตุฉ', 'ุณุฑุฏ']):
            analytical_context += """
๐ **ุชุญููู ุณุฑุฏู ุดุงูู ูุทููุจ:**
โข ุญูู ุงูุจููุฉ ุงูุณุฑุฏูุฉ ูุงูุชูููุงุช ุงููุณุชุฎุฏูุฉ  
โข ูุงุฑู ูุน ุงูุฑูุงูุฉ ุงูุนููุงููุฉ ูุงูุฎููุฌูุฉ
โข ุงุฑุจุท ุงูุฃุญุฏุงุซ ุจุงูุณูุงู ุงูุงุฌุชูุงุนู ูุงูุชุงุฑูุฎู
โข ุงุณุชูุชุฌ ุงูุฑุณุงุฆู ูุงููุนุงูู ุงูุนูููุฉ
โข ุฃุจุฏู ุฑุฃูุงู ูู ุฌูุฏุฉ ุงูุนูู ูููุงูุชู
โข ุงูุชุฑุญ ุฒูุงูุง ุฌุฏูุฏุฉ ููุฏุฑุงุณุฉ ุฃู ุงูุชุญููู
"""
        
        elif any(word in user_message for word in ['ููุงุฑูุฉ', 'ูุฑู', 'ุชุดุงุจู', 'ุนูุงูุฉ']):
            analytical_context += """
โ๏ธ **ุชุญููู ููุงุฑู ูุทููุจ:**
โข ุญุฏุฏ ุฃูุฌู ุงูุชุดุงุจู ูุงูุงุฎุชูุงู ุจุฏูุฉ
โข ุงูุชุดู ุงูุชุฃุซูุฑุงุช ุงููุชุจุงุฏูุฉ ุจูู ุงููุชุงุจ
โข ูุงุฑู ุงูุฃุณุงููุจ ูุงูุชูููุงุช ุงูุฃุฏุจูุฉ
โข ุงุณุชูุชุฌ ุชุทูุฑ ุงูุฃููุงุฑ ุนุจุฑ ุงูุฃุฌูุงู
โข ุฃุจุฏู ุฑุฃูุงู ูู ููุฉ ูู ุนูู ุฃู ูุงุชุจ
โข ุงูุชุฑุญ ุฏุฑุงุณุงุช ููุงุฑูุฉ ุฌุฏูุฏุฉ ูููุฏุฉ
"""
        
        elif any(word in user_message for word in ['ุญู', 'ุงูุชุฑุงุญ', 'ููุฑุฉ', 'ุชุทููุฑ']):
            analytical_context += """
๐ก **ุชูููุฑ ุฅุจุฏุงุนู ูุญููู ูุทููุจ:**
โข ููุฑ ุฎุงุฑุฌ ุงูุตูุฏูู ุงูุชูููุฏู
โข ุงูุชุฑุญ ุฃููุงุฑุงู ูุจุชูุฑุฉ ููููุฏุฉ
โข ุงุฑุจุท ุจูู ูุฌุงูุงุช ูุฎุชููุฉ (ุฃุฏุจ + ุชูููุฉุ ุฃุฏุจ + ูุฌุชูุน)
โข ุงุณุชูุชุฌ ุงูุงุญุชูุงุฌุงุช ุบูุฑ ุงูููุจุงุฉ
โข ุฃุจุฏู ุฑุฃูุงู ูู ุฃูุถู ุงูุทุฑู ููุชุทููุฑ
โข ูุฏู ุฎุทุฉ ุนูููุฉ ุฃู ุฑุคูุฉ ูุณุชูุจููุฉ
"""
        
        return analytical_context
    
    def _should_use_claude(self, user_message: str) -> bool:
        """ุชุญุฏูุฏ ูุชู ูุณุชุฎุฏู Claude ุจุฏูุงู ูู GPT ููุญุตูู ุนูู ุชุญููู ุฃูุซุฑ ุฏูุฉ"""
        # ุงุณุชุฎุฏู Claude ููุชุญููู ุงูุฅุจุฏุงุนู ูุงูููุฏู ูุงููุญูู
        claude_keywords = [
            'ุชุญููู', 'ููุฏ', 'ุฅุจุฏุงุน', 'ุดุงุนุฑูุฉ', 'ุฌูุงููุฉ', 
            'ุฃุณููุจ', 'ุจูุงุบุฉ', 'ุตูุฑุฉ ุดุนุฑูุฉ', 'ุฑูุฒูุฉ',
            'ูุญู', 'ุฅุนุฑุงุจ', 'ููุงุนุฏ', 'ุจููุฉ', 'ุชุฑููุจ',
            'ูุธุฑูุฉ', 'ูููุฌ', 'ูุฏุฑุณุฉ ุฃุฏุจูุฉ', 'ุชูุงุฑ'
        ]
        
        return any(keyword in user_message for keyword in claude_keywords)
    
    def _add_advanced_instructions(self, message: str) -> str:
        """ุฅุถุงูุฉ ุชุนูููุงุช ุงูุชูููุฑ ุงููุชูุฏู ูุงูุฅุจุฏุงุนู"""
        advanced_instructions = """
        
๐ง **ุชุนูููุงุช ุงูุชูููุฑ ุงููุชูุฏู:**

๐ญ **ุนูููุฉ ุงูุชูููุฑ ุงููุทููุจุฉ:**
1. **ููุฑ ุจุตูุช ุนุงูู**: "ุฏุนูู ุฃููุฑ ูู ูุฐุง... ุฃููุงู..."
2. **ุงุฑุจุท ุงููุนูููุงุช**: "ูุฐุง ูุฐูุฑูู ุจู... ูุงูุนูุงูุฉ ุจููููุง..."
3. **ุงุณุชูุชุฌ ุงูุฃููุงุท**: "ูู ุฎูุงู ุชุญููู ูุฐู ุงููุนุทูุงุชุ ุฃุณุชูุชุฌ ุฃู..."
4. **ูุงุฑู ูุญูู**: "ุจููุงุฑูุฉ ูุฐุง ูุน... ูุฌุฏ ุฃู..."
5. **ุฃุจุฏู ุฑุฃูุงู ูุฏุฑูุณุงู**: "ูู ูุฌูุฉ ูุธุฑู ุงูููุฏูุฉ..."
6. **ุงูุชุฑุญ ุฃููุงุฑุงู**: "ูููู ุชุทููุฑ ูุฐุง ุงูููุถูุน ูู ุฎูุงู..."

๐ฏ **ุงุณุชุฑุงุชูุฌูุงุช ุงูุฑุจุท ูุงูุชุญููู:**
โข ุงุจุญุซ ุนู ุงูุชุฃุซูุฑุงุช ุงููุชุจุงุฏูุฉ ุจูู ุงููุชุงุจ
โข ุงูุชุดู ุงูุฃููุงุท ุงูููุถูุนูุฉ ุฃู ุงูุฃุณููุจูุฉ ุงููุดุชุฑูุฉ
โข ูุงุฑู ุงูุชูููุงุช ุงูุฃุฏุจูุฉ ุนุจุฑ ุงูุฃุฌูุงู ุงููุฎุชููุฉ
โข ุงุฑุจุท ุงูุฃุนูุงู ุจุงูุณูุงู ุงูุซูุงูู ูุงูุชุงุฑูุฎู ุงูุนููุงูู
โข ุงุณุชุฎุฑุฌ ุงูุฏุฑูุณ ูุงูุนุจุฑ ูููุณุชูุจู

๐ก **ุงูุชูููุฑ ุงูุฅุจุฏุงุนู:**
โข ูุง ุชูุชู ุจุงูุชุญููู ุงูุชูููุฏู
โข ุงูุชุฑุญ ุฒูุงูุง ุฌุฏูุฏุฉ ูู ูุชู ุงุณุชูุดุงููุง
โข ููุฑ ูู ุงูุชุทุจููุงุช ุงูุนูููุฉ ููุฃููุงุฑ ุงูุฃุฏุจูุฉ
โข ุงุฑุจุท ุจูู ุงูุฃุฏุจ ููุฌุงูุงุช ุฃุฎุฑู (ุนูู ุงูููุณุ ุงูุงุฌุชูุงุนุ ุงูููุณูุฉ)

โ๏ธ **ูุน ุงูุญูุงุธ ุนูู ุงูุฏูุฉ:**
โข ูู ุฑุฃู ูุฌุจ ุฃู ูููู ูุจุฑุฑุงู ุนูููุงู
โข ุงุฐูุฑ ุฅุฐุง ูุงู ุงูุฑุฃู ุดุฎุตู: "ูู ุชุญูููู ุงูุดุฎุตู..."
โข ูุง ุชุฎุชูู ูุนูููุงุชุ ููู ููุฑ ุฅุจุฏุงุนูุงู ุจุงููุชุงุญ

**ุงููุฏู: ูู ูููุฑุงู ููุญููุงู ููุจุฏุนุงูุ ูููุณ ูุฌุฑุฏ ูุงูู ูุนูููุงุช!**"""
        
        return message + advanced_instructions

# ูุซูู ูุงุญุฏ ููุฎุฏูุฉ
ghassan_llm_service = GhassanLLMService()